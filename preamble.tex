\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{lipsum}
\usepackage{indentfirst}
\usepackage{color}
\usepackage{url}
\usepackage{atbegshi}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{enumitem}
\usepackage{microtype}
\usepackage{etoolbox}

\abnormalparskip{0pt}

% Fonts
\usepackage{mathptmx} % math
\usepackage{sourcesanspro} % sans-serif
\usepackage{charter} % serif

% Subfloats
\newsubfloat{figure} % Subfigures
\newsubfloat{table} % Subtables

% Date
\usepackage{datetime}
\newdateformat{titlepagedate}{\monthname[\THEMONTH] \THEYEAR}

% Margins
\setlrmarginsandblock{2.9cm}{2cm}{*}
\setulmarginsandblock{2.5cm}{2.5cm}{*}
\checkandfixthelayout

% Chapter style
\makechapterstyle{chstyle}{%
	\renewcommand\chapnamefont{%
		\normalfont\Huge\sffamily
	}
	\renewcommand\chaptitlefont{%
		\normalfont\Huge\sffamily\bfseries
	}
	\renewcommand\printchapternum{\chapnamefont\HUGE\thechapter}
}
\chapterstyle{chstyle}

% Headers and footers
\definecolor{shadecolor}{rgb}{.4, .4, .4}
% Normal page style
\makepagestyle{hfpage}
%\makeevenhead{hfpage}{\color{shadecolor}\scshape\leftmark}{}{}
%\makeoddhead{hfpage}{}{}{\color{shadecolor}\scshape\rightmark}
%\makeevenfoot{hfpage}{\color{shadecolor}\thepage}{}{}
%\makeoddfoot{hfpage}{}{}{\color{shadecolor}\thepage}
\makeevenhead{hfpage}{\thepage}{}{\leftmark}
\makeoddhead{hfpage}{\rightmark}{}{\thepage}
\makeevenfoot{hfpage}{}{}{}
\makeoddfoot{hfpage}{}{}{}

\makepsmarks{hfpage}{%
	\nouppercaseheads
	\createmark{chapter}{left}{shownumber}{}{. \space}
}

% Chapters
\makepagestyle{hfchapter}
\makeevenhead{hfchapter}{}{}{}
\makeoddhead{hfchapter}{}{}{}
\makeevenfoot{hfchapter}{\color{shadecolor}\thepage}{}{}
\makeoddfoot{hfchapter}{}{}{\color{shadecolor}\thepage}

\pagestyle{hfpage}
\aliaspagestyle{chapter}{hfchapter}

% Bibliography
\usepackage[style=authoryear, backend=biber, sorting=none, maxcitenames=2, maxbibnames=99, firstinits=true, uniquename=false, uniquelist=false, url=false, doi=false, isbn=false, dashed=false, natbib=true]{biblatex}

% Print your publication
\newcommand{\printpublication}[1]{\AtNextCite{\defcounter{maxnames}{99}}\myprintpublication{#1}}
\DeclareCiteCommand{\myprintpublication}
{%
	\boolfalse{citetracker}%
	\boolfalse{pagetracker}%
	\DeclareNameAlias{labelname}{first-last}%
	\usebibmacro{prenote}}
{\ifciteindex
	{\indexnames{labelname}}
	{}%
	\printnames{labelname}. \printfield{title}. %
	\ifentrytype{inproceedings}{\printfield{booktitle}}{}%
	\ifentrytype{article}{\printfield{journaltitle}}{}, \printfield{year}.}
{\multicitedelim}
{\usebibmacro{postnote}}

% Remove In: from journal articles
\renewbibmacro{in:}{%
	\ifentrytype{article}{}{%
		\ifentrytype{inproceedings}{}{%
			\printtext{\bibstring{in}\intitlepunct}
		}
	}
}

% Bib resource file
\addbibresource{bib/library.bib}

% Change table of contents name
% Rename appendix chapter name
\addto\captionsenglish{% Replace "english" with the language you use
	\renewcommand\contentsname{Table of Contents}%
	\renewcommand\appendixname{Paper}
	\renewcommand\appendixpagename{Papers}
}
\renewcommand*{\cftappendixname}{Paper\space}